"use strict";(self.webpackChunktoken_allowance_checker=self.webpackChunktoken_allowance_checker||[]).push([[3297],{973297:function(e,n,t){t.r(n),t.d(n,{default:function(){return k}});var r=t(115861),o=t(215671),i=t(143144),a=t(497326),s=t(360136),u=t(329388),c=t(887757),p=t.n(c),d=t(911437),l=t(737762),f=t(868041),g=t.n(f),h={},E={},v=function(e,n){E[e]=n},_=function(e){var n=function(n,t){Object.assign(this,t),this.name=e,this.message=n||e,this.stack=(new Error).stack};return n.prototype=new Error,h[e]=n,n};_("AccountNameRequired"),_("AccountNotSupported"),_("AmountRequired"),_("BluetoothRequired"),_("BtcUnmatchedApp"),_("CantOpenDevice"),_("CashAddrNotSupported"),_("CurrencyNotSupported"),_("DeviceAppVerifyNotSupported"),_("DeviceGenuineSocketEarlyClose"),_("DeviceNotGenuine"),_("DeviceOnDashboardExpected"),_("DeviceOnDashboardUnexpected"),_("DeviceInOSUExpected"),_("DeviceHalted"),_("DeviceNameInvalid"),_("DeviceSocketFail"),_("DeviceSocketNoBulkStatus"),_("DisconnectedDevice"),_("DisconnectedDeviceDuringOperation"),_("EnpointConfig"),_("EthAppPleaseEnableContractData"),_("FeeEstimationFailed"),_("FirmwareNotRecognized"),_("HardResetFail"),_("InvalidXRPTag"),_("InvalidAddress"),_("InvalidAddressBecauseDestinationIsAlsoSource"),_("LatestMCUInstalledError"),_("UnknownMCU"),_("LedgerAPIError"),_("LedgerAPIErrorWithMessage"),_("LedgerAPINotAvailable"),_("ManagerAppAlreadyInstalled"),_("ManagerAppRelyOnBTC"),_("ManagerAppDepInstallRequired"),_("ManagerAppDepUninstallRequired"),_("ManagerDeviceLocked"),_("ManagerFirmwareNotEnoughSpace"),_("ManagerNotEnoughSpace"),_("ManagerUninstallBTCDep"),_("NetworkDown"),_("NoAddressesFound"),_("NotEnoughBalance"),_("NotEnoughBalanceToDelegate"),_("NotEnoughBalanceInParentAccount"),_("NotEnoughSpendableBalance"),_("NotEnoughBalanceBecauseDestinationNotCreated"),_("NoAccessToCamera"),_("NotEnoughGas"),_("NotSupportedLegacyAddress"),_("GasLessThanEstimate"),_("PasswordsDontMatch"),_("PasswordIncorrect"),_("RecommendSubAccountsToEmpty"),_("RecommendUndelegation"),_("TimeoutTagged"),_("UnexpectedBootloader"),_("MCUNotGenuineToDashboard"),_("RecipientRequired"),_("UnavailableTezosOriginatedAccountReceive"),_("UnavailableTezosOriginatedAccountSend"),_("UpdateFetchFileFail"),_("UpdateIncorrectHash"),_("UpdateIncorrectSig"),_("UpdateYourApp"),_("UserRefusedDeviceNameChange"),_("UserRefusedAddress"),_("UserRefusedFirmwareUpdate"),_("UserRefusedAllowManager"),_("UserRefusedOnDevice"),_("TransportOpenUserCancelled"),_("TransportInterfaceNotAvailable");var m=_("TransportRaceCondition");_("TransportWebUSBGestureRequired"),_("DeviceShouldStayInApp"),_("WebsocketConnectionError"),_("WebsocketConnectionFailed"),_("WrongDeviceForAccount"),_("WrongAppForCurrency"),_("ETHAddressNonEIP"),_("CantScanQRCode"),_("FeeNotLoaded"),_("FeeRequired"),_("FeeTooHigh"),_("SyncError"),_("PairingFailed"),_("GenuineCheckFailed"),_("LedgerAPI4xx"),_("LedgerAPI5xx"),_("FirmwareOrAppUpdateRequired"),_("NoDBPathGiven"),_("DBWrongPassword"),_("DBNotReset");function T(e,n){this.name="TransportError",this.message=e,this.stack=(new Error).stack,this.id=n}T.prototype=new Error,v("TransportError",(function(e){return new T(e.message,e.id)}));var I={PIN_REMAINING_ATTEMPTS:25536,INCORRECT_LENGTH:26368,MISSING_CRITICAL_PARAMETER:26624,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,SECURITY_STATUS_NOT_SATISFIED:27010,CONDITIONS_OF_USE_NOT_SATISFIED:27013,INCORRECT_DATA:27264,NOT_ENOUGH_MEMORY_SPACE:27268,REFERENCED_DATA_NOT_FOUND:27272,FILE_ALREADY_EXISTS:27273,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,CLA_NOT_SUPPORTED:28160,TECHNICAL_PROBLEM:28416,OK:36864,MEMORY_PROBLEM:37440,NO_EF_SELECTED:37888,INVALID_OFFSET:37890,FILE_NOT_FOUND:37892,INCONSISTENT_FILE:37896,ALGORITHM_NOT_SUPPORTED:38020,INVALID_KCV:38021,CODE_NOT_INITIALIZED:38914,ACCESS_CONDITION_NOT_FULFILLED:38916,CONTRADICTION_SECRET_CODE_STATUS:38920,CONTRADICTION_INVALIDATION:38928,CODE_BLOCKED:38976,MAX_VALUE_REACHED:38992,GP_AUTH_FAILED:25344,LICENSING:28482,HALTED:28586};function N(e){this.name="TransportStatusError";var n=Object.keys(I).find((function(n){return I[n]===e}))||"UNKNOWN_ERROR",t=function(e){switch(e){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received"}if(28416<=e&&e<=28671)return"Internal error, please report"}(e)||n,r=e.toString(16);this.message="Ledger device: "+t+" (0x"+r+")",this.stack=(new Error).stack,this.statusCode=e,this.statusText=n}N.prototype=new Error,v("TransportStatusError",(function(e){return new N(e.statusCode)}));var S=t(740918).Buffer,R=function(){function e(){var n=this;(0,o.Z)(this,e),this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new(g()),this.send=function(){var e=(0,r.Z)(p().mark((function e(t,r,o,i){var a,s,u,c,d=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=d.length>4&&void 0!==d[4]?d[4]:S.alloc(0),s=d.length>5&&void 0!==d[5]?d[5]:[I.OK],!(a.length>=256)){e.next=4;break}throw new T("data.length exceed 256 bytes limit. Got: "+a.length,"DataLengthTooBig");case 4:return e.next=6,n.exchange(S.concat([S.from([t,r,o,i]),S.from([a.length]),a]));case 6:if(u=e.sent,c=u.readUInt16BE(u.length-2),s.some((function(e){return e===c}))){e.next=10;break}throw new N(c);case 10:return e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(n,t,r,o){return e.apply(this,arguments)}}(),this.exchangeBusyPromise=void 0,this.exchangeAtomicImpl=function(){var e=(0,r.Z)(p().mark((function e(t){var r,o,i,a,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.exchangeBusyPromise){e.next=2;break}throw new m("An action was already pending on the Ledger device. Please deny or reconnect.");case 2:return o=new Promise((function(e){r=e})),n.exchangeBusyPromise=o,i=!1,a=setTimeout((function(){i=!0,n.emit("unresponsive")}),n.unresponsiveTimeout),e.prev=6,e.next=9,t();case 9:return s=e.sent,i&&n.emit("responsive"),e.abrupt("return",s);case 12:return e.prev=12,clearTimeout(a),r&&r(),n.exchangeBusyPromise=null,e.finish(12);case 17:case"end":return e.stop()}}),e,null,[[6,,12,17]])})));return function(n){return e.apply(this,arguments)}}(),this._appAPIlock=null}return(0,i.Z)(e,[{key:"exchange",value:function(e){throw new Error("exchange not implemented")}},{key:"setScrambleKey",value:function(e){}},{key:"close",value:function(){return Promise.resolve()}},{key:"on",value:function(e,n){this._events.on(e,n)}},{key:"off",value:function(e,n){this._events.removeListener(e,n)}},{key:"emit",value:function(e){for(var n,t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];(n=this._events).emit.apply(n,[e].concat(r))}},{key:"setDebugMode",value:function(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}},{key:"setExchangeTimeout",value:function(e){this.exchangeTimeout=e}},{key:"setExchangeUnresponsiveTimeout",value:function(e){this.unresponsiveTimeout=e}},{key:"decorateAppAPIMethods",value:function(e,n,t){var r,o=(0,l.Z)(n);try{for(o.s();!(r=o.n()).done;){var i=r.value;e[i]=this.decorateAppAPIMethod(i,e[i],e,t)}}catch(a){o.e(a)}finally{o.f()}}},{key:"decorateAppAPIMethod",value:function(e,n,t,o){var i=this;return(0,r.Z)(p().mark((function r(){var a,s,u,c,d=arguments;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(a=i._appAPIlock)){r.next=3;break}return r.abrupt("return",Promise.reject(new T("Ledger Device is busy (lock "+a+")","TransportLocked")));case 3:for(r.prev=3,i._appAPIlock=e,i.setScrambleKey(o),s=d.length,u=new Array(s),c=0;c<s;c++)u[c]=d[c];return r.next=9,n.apply(t,u);case 9:return r.abrupt("return",r.sent);case 10:return r.prev=10,i._appAPIlock=null,r.finish(10);case 13:case"end":return r.stop()}}),r,null,[[3,,10,13]])})))}}],[{key:"create",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e3,t=arguments.length>1?arguments[1]:void 0;return new Promise((function(r,o){var i=!1,a=e.listen({next:function(t){i=!0,a&&a.unsubscribe(),s&&clearTimeout(s),e.open(t.descriptor,n).then(r,o)},error:function(e){s&&clearTimeout(s),o(e)},complete:function(){s&&clearTimeout(s),i||o(new T(e.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),s=t?setTimeout((function(){a.unsubscribe(),o(new T(e.ErrorMessage_ListenTimeout,"ListenTimeout"))}),t):null}))}}]),e}();R.isSupported=void 0,R.list=void 0,R.listen=void 0,R.open=void 0,R.ErrorMessage_ListenTimeout="No Ledger device found (timeout)",R.ErrorMessage_NoDeviceFound="No Ledger device found";var A=0,C=[],w=function(e,n,t){var r={type:e,id:String(++A),date:new Date};n&&(r.message=n),t&&(r.data=t),function(e){for(var n=0;n<C.length;n++)try{C[n](e)}catch(t){console.error(t)}}(r)};"undefined"!==typeof window&&(window.__ledgerLogsListen=function(e){return C.push(e),function(){var n=C.indexOf(e);-1!==n&&(C[n]=C[C.length-1],C.pop())}});var y=t(740918).Buffer;function D(e,n,t){var r=new T(n,t);return r.originalError=e,r}var O=function(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")};function U(e,n,t,r){var o=function(e,n){for(var t=y.alloc(e.length),r=0;r<e.length;r++)t[r]=e[r]^n[r%n.length];return t}(e,t),i=y.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),a={version:"U2F_V2",keyHandle:O(o.toString("base64")),challenge:O(i.toString("base64")),appId:location.origin};return w("apdu","=> "+e.toString("hex")),(0,d.sign)(a,n/1e3).then((function(e){var n,t=e.signatureData;if("string"===typeof t){var o,i=y.from((n=t).replace(/-/g,"+").replace(/_/g,"/")+"==".substring(0,3*n.length%4),"base64");return o=r?i.slice(5):i,w("apdu","<= "+o.toString("hex")),o}throw e}))}var P=[];var k=function(e){(0,s.Z)(t,e);var n=(0,u.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=n.call(this)).scrambleKey=void 0,e.unwrap=!0,P.push((0,a.Z)(e)),e}return(0,i.Z)(t,[{key:"exchange",value:function(){var e=(0,r.Z)(p().mark((function e(n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U(n,this.exchangeTimeout,this.scrambleKey,this.unwrap);case 3:return e.abrupt("return",e.sent);case 6:if(e.prev=6,e.t0=e.catch(0),!("object"===typeof e.t0.metaData)){e.next=14;break}throw 5===e.t0.metaData.code&&(P.forEach((function(e){return e.emit("disconnect")})),P=[]),D(e.t0,"Failed to sign with Ledger device: U2F "+e.t0.metaData.type,"U2F_"+e.t0.metaData.code);case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(n){return e.apply(this,arguments)}}()},{key:"setScrambleKey",value:function(e){this.scrambleKey=y.from(e,"ascii")}},{key:"setUnwrap",value:function(e){this.unwrap=e}},{key:"close",value:function(){return Promise.resolve()}}],[{key:"open",value:function(){var e=(0,r.Z)(p().mark((function e(n){var r=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>1&&void 0!==r[1]?r[1]:5e3,e.abrupt("return",new t);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}]),t}(R);k.isSupported=d.isSupported,k.list=function(){return(0,d.isSupported)().then((function(e){return e?[null]:[]}))},k.listen=function(e){var n=!1;return(0,d.isSupported)().then((function(t){n||(t?(e.next({type:"add",descriptor:null}),e.complete()):e.error(new T("U2F browser support is needed for Ledger. Please use Chrome, Opera or Firefox with a U2F extension. Also make sure you're on an HTTPS connection","U2FNotSupported")))})),{unsubscribe:function(){n=!0}}}},911437:function(e,n,t){e.exports=t(693947)},566945:function(e){var n=n||{};e.exports=n,n.EXTENSION_ID="kmendfapggjehodndflmmgagdbamhnfd",n.MessageTypes={U2F_REGISTER_REQUEST:"u2f_register_request",U2F_SIGN_REQUEST:"u2f_sign_request",U2F_REGISTER_RESPONSE:"u2f_register_response",U2F_SIGN_RESPONSE:"u2f_sign_response"},n.ErrorCodes={OK:0,OTHER_ERROR:1,BAD_REQUEST:2,CONFIGURATION_UNSUPPORTED:3,DEVICE_INELIGIBLE:4,TIMEOUT:5},n.Request,n.Response,n.Error,n.SignRequest,n.SignResponse,n.RegisterRequest,n.RegisterResponse,n.disconnect=function(){n.port_&&n.port_.port_&&(n.port_.port_.disconnect(),n.port_=null)},n.getMessagePort=function(e){if("undefined"!=typeof chrome&&chrome.runtime){var t={type:n.MessageTypes.U2F_SIGN_REQUEST,signRequests:[]};chrome.runtime.sendMessage(n.EXTENSION_ID,t,(function(){chrome.runtime.lastError?n.getIframePort_(e):n.getChromeRuntimePort_(e)}))}else n.getIframePort_(e)},n.getChromeRuntimePort_=function(e){var t=chrome.runtime.connect(n.EXTENSION_ID,{includeTlsChannelId:!0});setTimeout((function(){e(null,new n.WrappedChromeRuntimePort_(t))}),0)},n.WrappedChromeRuntimePort_=function(e){this.port_=e},n.WrappedChromeRuntimePort_.prototype.postMessage=function(e){this.port_.postMessage(e)},n.WrappedChromeRuntimePort_.prototype.addEventListener=function(e,n){var t=e.toLowerCase();"message"==t||"onmessage"==t?this.port_.onMessage.addListener((function(e){n({data:e})})):console.error("WrappedChromeRuntimePort only supports onMessage")},n.getIframePort_=function(e){var t="chrome-extension://"+n.EXTENSION_ID,r=document.createElement("iframe");r.src=t+"/u2f-comms.html",r.setAttribute("style","display:none"),document.body.appendChild(r);var o=!1,i=new MessageChannel;i.port1.addEventListener("message",(function n(t){"ready"==t.data?(i.port1.removeEventListener("message",n),o||(o=!0,e(null,i.port1))):console.error('First event on iframe port was not "ready"')})),i.port1.start(),r.addEventListener("load",(function(){r.contentWindow.postMessage("init",t,[i.port2])})),setTimeout((function(){o||(o=!0,e(new Error("IFrame extension not supported")))}),200)},n.EXTENSION_TIMEOUT_SEC=30,n.port_=null,n.waitingForPort_=[],n.reqCounter_=0,n.callbackMap_={},n.getPortSingleton_=function(e){n.port_?e(null,n.port_):(0==n.waitingForPort_.length&&n.getMessagePort((function(e,t){for(e||(n.port_=t,n.port_.addEventListener("message",n.responseHandler_));n.waitingForPort_.length;)n.waitingForPort_.shift()(e,t)})),n.waitingForPort_.push(e))},n.responseHandler_=function(e){var t=e.data,r=t.requestId;if(r&&n.callbackMap_[r]){var o=n.callbackMap_[r];delete n.callbackMap_[r],o(null,t.responseData)}else console.error("Unknown or missing requestId in response.")},n.isSupported=function(e){n.getPortSingleton_((function(n,t){e(!n)}))},n.sign=function(e,t,r){n.getPortSingleton_((function(o,i){if(o)return t(o);var a=++n.reqCounter_;n.callbackMap_[a]=t;var s={type:n.MessageTypes.U2F_SIGN_REQUEST,signRequests:e,timeoutSeconds:"undefined"!==typeof r?r:n.EXTENSION_TIMEOUT_SEC,requestId:a};i.postMessage(s)}))},n.register=function(e,t,r,o){n.getPortSingleton_((function(i,a){if(i)return r(i);var s=++n.reqCounter_;n.callbackMap_[s]=r;var u={type:n.MessageTypes.U2F_REGISTER_REQUEST,signRequests:t,registerRequests:e,timeoutSeconds:"undefined"!==typeof o?o:n.EXTENSION_TIMEOUT_SEC,requestId:s};a.postMessage(u)}))}},693947:function(e,n,t){e.exports=c;var r=t(566945),o="undefined"!==typeof navigator&&!!navigator.userAgent,i=o&&navigator.userAgent.match(/Safari\//)&&!navigator.userAgent.match(/Chrome\//),a=o&&navigator.userAgent.match(/Edge\/1[2345]/),s=null;function u(e){return s||(s=new e((function(e,n){function t(){e({u2f:null,native:!0})}return o?i?t():("undefined"!==typeof window.u2f&&"function"===typeof window.u2f.sign&&e({u2f:window.u2f,native:!0}),a||"http:"===location.protocol||"undefined"===typeof MessageChannel?t():void r.isSupported((function(n){n?e({u2f:r,native:!1}):t()}))):t()}))),s}function c(e){return{isSupported:l.bind(e),ensureSupport:g.bind(e),register:h.bind(e),sign:E.bind(e),ErrorCodes:c.ErrorCodes,ErrorNames:c.ErrorNames}}function p(e,n){var t=null!=n?n.errorCode:1,r=c.ErrorNames[""+t],o=new Error(e);return o.metaData={type:r,code:t},o}function d(e,n){var t={};return t.promise=new e((function(e,r){t.resolve=e,t.reject=r,n.then(e,r)})),t.promise.cancel=function(n,r){u(e).then((function(e){r&&!e.native&&e.u2f.disconnect(),t.reject(p(n,{errorCode:-1}))}))},t}function l(){return u(this).then((function(e){return!!e.u2f}))}function f(e){if(!e.u2f){if("http:"===location.protocol)throw new Error("U2F isn't supported over http, only https");throw new Error("U2F not supported")}}function g(){return u(this).then(f)}function h(e,n,t){var r=this;return Array.isArray(e)||(e=[e]),"number"===typeof n&&"undefined"===typeof t&&(t=n,n=null),n||(n=[]),d(r,u(r).then((function(o){f(o);var i=o.native,a=o.u2f;return new r((function(r,o){if(i){var s=e[0].appId;a.register(s,e,n,(function(e){e.errorCode?o(p("Registration failed",e)):(delete e.errorCode,r(e))}),t)}else a.register(e,n,(function(e,n){e?o(e):n.errorCode?o(p("Registration failed",n)):r(n)}),t)}))}))).promise}function E(e,n){var t=this;return Array.isArray(e)||(e=[e]),d(t,u(t).then((function(r){f(r);var o=r.native,i=r.u2f;return new t((function(t,r){if(o){var a=e[0].appId,s=e[0].challenge;i.sign(a,s,e,(function(e){e.errorCode?r(p("Sign failed",e)):(delete e.errorCode,t(e))}),n)}else i.sign(e,(function(e,n){e?r(e):n.errorCode?r(p("Sign failed",n)):t(n)}),n)}))}))).promise}function v(e){c[e]=function(){if(!t.g.Promise)throw new Error("The platform doesn't natively support promises");var n=[].slice.call(arguments);return c(t.g.Promise)[e].apply(null,n)}}c.ErrorCodes={CANCELLED:-1,OK:0,OTHER_ERROR:1,BAD_REQUEST:2,CONFIGURATION_UNSUPPORTED:3,DEVICE_INELIGIBLE:4,TIMEOUT:5},c.ErrorNames={"-1":"CANCELLED",0:"OK",1:"OTHER_ERROR",2:"BAD_REQUEST",3:"CONFIGURATION_UNSUPPORTED",4:"DEVICE_INELIGIBLE",5:"TIMEOUT"},v("isSupported"),v("ensureSupport"),v("register"),v("sign")}}]);